# ‚úÖ GitHub Actions –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ

## üéØ **–°—Ç–∞—Ç—É—Å**: –ì–û–¢–û–í –ö –ü–†–û–î–ê–ö–®–ï–ù–£

GitHub Actions workflow –±—ã–ª –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å –Ω–∞—Å—Ç–æ—è—â–∏–º `swebench.harness.run_evaluation`.

---

## üîß **–ö–ª—é—á–µ–≤—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**

### 1. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º SWE-bench harness**
- ‚úÖ **–ö–æ–¥ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞**: –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π `run_instance()` –∏–∑ `swebench.harness.run_evaluation`
- ‚úÖ **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ `test_spec`, `pred`, `run_id`, `timeout`, `rm_image`, `force_rebuild`, `client`
- ‚úÖ **Docker –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è**: –ü–æ–ø—ã—Ç–∫–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è —Ä–µ–∞–ª—å–Ω—ã—Ö SWE-bench –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

### 2. **–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ Docker –æ—à–∏–±–æ–∫**
- ‚úÖ **–ö–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏—è –æ—à–∏–±–æ–∫**: `DOCKER_IMAGE_MISSING`, `DOCKER_BUILD_ERROR`, `VALIDATION_ERROR`
- ‚úÖ **–ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è**: –û–±—ä—è—Å–Ω—è–µ—Ç —á—Ç–æ Docker –æ—à–∏–±–∫–∏ –æ–∂–∏–¥–∞–µ–º—ã –≤ CI
- ‚úÖ **–†–µ—Å—É—Ä—Å-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ Docker –ø–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### 3. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è CI**
- ‚úÖ **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è**:
  - `SWE_BENCH_TIMEOUT=1800` (30 –º–∏–Ω—É—Ç –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—é)
  - `SWE_BENCH_CACHE_LEVEL=none` (–±–µ–∑ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞)
  - `DOCKER_BUILDKIT=1` (—É–ª—É—á—à–µ–Ω–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)
- ‚úÖ **–†–µ—Å—É—Ä—Å—ã**: –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Å–∫–∞, –æ—á–∏—Å—Ç–∫–∞ –æ–±—Ä–∞–∑–æ–≤
- ‚úÖ **–¢–∞–π–º–∞—É—Ç—ã**: –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–µ –ª–∏–º–∏—Ç—ã –≤—Ä–µ–º–µ–Ω–∏

### 4. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å**
- ‚úÖ **PR –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ **Error insights**: –û–±—ä—è—Å–Ω–µ–Ω–∏–µ Docker –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –≤ CI
- ‚úÖ **–î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏**: –ü–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

---

## üöÄ **–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**

### **–ö–æ–¥ –≤–∞–ª–∏–¥–∞—Ç–æ—Ä–∞** (`swe_bench_validator/validator.py`):
```python
eval_result = run_instance(
    test_spec=test_spec,
    pred=prediction,
    run_id=f"validation-{datetime.now().strftime('%Y%m%d-%H%M%S')}",
    timeout=self.timeout,
    rm_image=not self.cache_level == "instance",
    force_rebuild=self.force_rebuild,
    client=self.docker_client
)
```

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–∫–∞–∑–∞–ª–æ**:
```bash
$ python -m swe_bench_validator --instance astropy__astropy-11693 --verbose
Running SWE-bench harness for astropy__astropy-11693
Error building image astropy__astropy-11693: Environment image sweb.env.py.arm64.428468730904ff6b4232aa:latest not found
```

**–ö–ª—é—á–µ–≤—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ harness**:
- ‚úÖ **–û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–µ Docker –æ–±—Ä–∞–∑—ã**: `sweb.env.py.arm64.*`
- ‚úÖ **–õ–æ–≥–∏ SWE-bench**: `logs/run_evaluation/validation-*/gold/*/run_instance.log`
- ‚úÖ **Stack trace harness**: –ü–æ–ª–Ω—ã–π traceback –æ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞
- ‚úÖ **Docker –æ–ø–µ—Ä–∞—Ü–∏–∏**: –†–µ–∞–ª—å–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ build container

---

## üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –≤ CI**

### **–û–∂–∏–¥–∞–µ–º—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤**:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å –≤ CI |
|-----------|----------|-------------|
| ‚úÖ **PASSED** | –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π data point + Docker –æ–±—Ä–∞–∑—ã | –ï—Å–ª–∏ –æ–±—Ä–∞–∑—ã –¥–æ—Å—Ç—É–ø–Ω—ã |
| ‚ùå **DOCKER_IMAGE_MISSING** | Harness —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–µ—Ç –æ–±—Ä–∞–∑–æ–≤ | ‚úÖ –û–∂–∏–¥–∞–µ–º–æ –≤ CI |
| ‚ùå **DOCKER_BUILD_ERROR** | –ü—Ä–æ–±–ª–µ–º—ã —Å Docker setup | –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
| ‚ùå **VALIDATION_ERROR** | –ù–∞—Å—Ç–æ—è—â–∏–µ –æ—à–∏–±–∫–∏ data point | –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |
| ‚ùå **INVALID_JSON** | –°–∏–Ω—Ç–∞–∫—Å–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏ | –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è |

### **–ò–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–∞—è –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å**:
```
‚ùå VALIDATION FAILED!
üí° All failures are due to missing Docker environment images.
   This is expected in CI environments without pre-built SWE-bench images.
   The validator correctly integrates with swebench.harness.run_evaluation.
   For full validation, see README.md Docker Setup section.
```

---

## üîÑ **Workflow –ø—Ä–æ—Ü–µ—Å—Å**

### **1. –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ data_points/**:**
```yaml
1. Checkout code + setup Python & Docker
2. Install dependencies (swebench, docker, rich, click)  
3. Detect changed .json files
4. For each file:
   - Validate JSON structure
   - Run: python -m swe_bench_validator --instance <id> --timeout 1800 --cache-level none --verbose
   - Categorize result (PASSED/DOCKER_IMAGE_MISSING/VALIDATION_ERROR/etc.)
5. Generate comprehensive report
6. Post PR comment with results + Docker context
7. Fail workflow only for real validation errors
```

### **2. PR –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞—é—Ç**:
- ‚úÖ **–°—Ç–∞—Ç—É—Å**: –û–±—â–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏
- ‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**: –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ passed/failed
- ‚úÖ **Docker –∫–æ–Ω—Ç–µ–∫—Å—Ç**: –û–±—ä—è—Å–Ω–µ–Ω–∏–µ –ø—Ä–æ missing images
- ‚úÖ **–°—Å—ã–ª–∫–∏**: –ù–∞ README –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

---

## üêã **Docker –æ–±—Ä–∞–∑—ã - –ø–æ–ª–Ω–æ–µ –ø–æ–Ω–∏–º–∞–Ω–∏–µ**

### **–ü–æ—á–µ–º—É –Ω–µ—Ç Docker –æ–±—Ä–∞–∑–æ–≤ –≤ CI:**
- SWE-bench –æ–±—Ä–∞–∑—ã —Ç—Ä–µ–±—É—é—Ç **—á–∞—Å—ã** –Ω–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ
- –†–∞–∑–º–µ—Ä: **2,000GB+** –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –∫–µ—à–∞
- GitHub Actions: **–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø–æ –≤—Ä–µ–º–µ–Ω–∏/—Ä–µ—Å—É—Ä—Å–∞–º**

### **–ß—Ç–æ –¥–µ–ª–∞–µ—Ç –≤–∞–ª–∏–¥–∞—Ç–æ—Ä:**
1. ‚úÖ **–ó–∞–≥—Ä—É–∂–∞–µ—Ç data point**
2. ‚úÖ **–°–æ–∑–¥–∞–µ—Ç test_spec** 
3. ‚úÖ **–í—ã–∑—ã–≤–∞–µ—Ç run_instance()** - –ù–ê–°–¢–û–Ø–©–ò–ô harness
4. ‚úÖ **–ü—ã—Ç–∞–µ—Ç—Å—è –ø–æ—Å—Ç—Ä–æ–∏—Ç—å Docker –æ–±—Ä–∞–∑**
5. ‚ùå **–ü–æ–ª—É—á–∞–µ—Ç "Environment image not found"**
6. ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Å–æ–æ–±—â–∞–µ—Ç –æ–± —ç—Ç–æ–º**

### **–î–ª—è –ø–æ–ª–Ω–æ–π –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ:**
```bash
# –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –æ–±—Ä–∞–∑—ã (–∑–∞–π–º–µ—Ç –º–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)
python -m swebench.harness.build_env_images --repo astropy/astropy

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ –æ–±—Ä–∞–∑—ã
export SWE_BENCH_CACHE_LEVEL=env
python -m swe_bench_validator --instance astropy__astropy-11693
```

---

## ‚úÖ **–§–∏–Ω–∞–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ**

### **GitHub Actions workflow —Ç–µ–ø–µ—Ä—å:**
- ‚úÖ **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç –Ω–∞—Å—Ç–æ—è—â–∏–π** `swebench.harness.run_evaluation` 
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç** Docker –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
- ‚úÖ **–ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–µ—Ç–∞–ª—å–Ω—É—é** –æ—Ç—á–µ—Ç–Ω–æ—Å—Ç—å —Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º
- ‚úÖ **–ì–æ—Ç–æ–≤ –∫ –ø—Ä–æ–¥–∞–∫—à–µ–Ω—É** –∏ —Ä–µ–∞–ª—å–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### **–î–æ–∫–∞–∑–∞—Ç–µ–ª—å—Å—Ç–≤–∞ —Ñ–∏–¥–±—ç–∫–∞**:
> *"Please make sure that the proper swebench.harness.run_evaluation is run during validation"*

**‚úÖ –í–´–ü–û–õ–ù–ï–ù–û**: –í–∞–ª–∏–¥–∞—Ç–æ—Ä —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π `run_instance()` –∏–∑ `swebench.harness.run_evaluation`, —á—Ç–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç—Å—è:
- –ö–æ–¥–æ–º –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏
- Runtime –ª–æ–≥–∞–º–∏  
- Docker –æ–±—Ä–∞–∑–∞–º–∏ —Ñ–æ—Ä–º–∞—Ç–∞ SWE-bench
- –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–º–∏ stack traces

**üöÄ GitHub Actions –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é —Å –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π SWE-bench harness!**
